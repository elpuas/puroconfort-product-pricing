import{getContext as t,store as e}from"@wordpress/interactivity";const a=t=>{const e=Number(t)||0,a=Math.abs(e%1)>0,n=document.documentElement.lang||"es-MX";return`₡${e.toLocaleString(n,{minimumFractionDigits:a?2:0,maximumFractionDigits:a?2:0})}`},{state:n,actions:o}=e("puroconfort-pricing",{state:{quantity:1,price_single:0,price_bulk:0,productName:"",unit_price_applied:0,total:0,totalFormatted:""},actions:{init(){const e=t();n.quantity=Number(e.quantity)||1,n.price_single=Number(e.price_single)||0,n.price_bulk=Number(e.price_bulk)||0,n.productName=e.productName||"",o.update()},update(t){const e=t?Number.parseInt(t.target.value,10):n.quantity;n.quantity=Number.isFinite(e)&&e>=1?e:1,n.unit_price_applied=n.quantity>=12?n.price_bulk:n.price_single,n.total=n.quantity*n.unit_price_applied,n.totalFormatted=a(n.total),console.log("Quantity:",n.quantity),console.log("Unit price applied:",n.unit_price_applied),console.log("Total (raw):",n.total),console.log("State totalFormatted:",n.totalFormatted)},increment(){o.update({target:{value:n.quantity+1}})},decrement(){o.update({target:{value:n.quantity-1}})},openWhatsApp(t){const e=t.target.closest("[data-whatsapp-phone]"),o=e?e.dataset.whatsappPhone:"";if(!o)return void console.warn("puroconfort-pricing: WhatsApp phone number is not configured for this block.");const i=`${e.dataset.pageTitle||""}\n${e.dataset.pageUrl||""}\n\nCantidad seleccionada: ${n.quantity}\nTotal estimado: ${a(n.total)}\n\nPara que tu pedido salga más rápido, por favor indícanos:\n- Nombre completo: \n- Teléfono: \n- Correo electrónico: \n- Dirección de entrega: \n\nCantidad confirmada: `,r=`https://wa.me/${o}?text=${encodeURIComponent(i)}`;window.open(r,"_blank","noopener,noreferrer")}}});